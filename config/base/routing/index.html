<!doctype html><html><head><title>路由 :: Project X</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name=revised content="2021-02-09T14:04:28 UTC"><meta name=description content="Project X 的文档."><meta name=author content="Project X"><title>路由 :: Project X</title><link rel="shortcut icon" href=/images/favicon.png type=image/x-icon><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/css/bootstrap.min.css integrity=sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.css><script src=https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js></script><link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel=stylesheet><link rel=stylesheet type=text/css href=https://xtls.github.io/sass/layout.css><link rel=stylesheet type=text/css href=https://xtls.github.io/css/style.main.css><link rel=stylesheet type=text/css href=https://xtls.github.io/css/style.menu.css><link rel=stylesheet type=text/css href=https://xtls.github.io/sass/shortcodes/notice.css><link rel=stylesheet type=text/css href=https://xtls.github.io/sass/shortcodes/tabs.css><link rel=stylesheet type=text/css href=https://xtls.github.io/sass/shortcodes/panel.css><link rel=stylesheet type=text/css href=https://xtls.github.io/sass/shortcodes/columns.css><link rel=stylesheet type=text/css href=https://xtls.github.io/sass/shortcodes/children.css><link rel=stylesheet type=text/css href=https://xtls.github.io/sass/shortcodes/attachments.css><link rel=stylesheet type=text/css href=https://xtls.github.io/sass/shortcodes/alert.css><link rel=stylesheet type=text/css href=/css/docport.css><script src=/js/docport.js></script><script type=text/javascript>var baseurl="https:\/\/xtls.github.io";</script><link rel=stylesheet href=/css/custom.css></head><body data-url=/config/base/routing/><style type=text/css>#debug{display:-webkit-box;display:-ms-flexbox;display:flex;line-height:3.5rem;margin-bottom:.35rem;padding:0 2rem;position:fixed;left:0;right:0;top:0;top:0;min-height:150px;background-color:#fff;border:3px solid red;z-index:10000;word-wrap:all;overflow:auto}</style><header><div><div class=burger><a href=javascript:void(0); style=font-size:15px onclick="$('article > aside').toggleClass('responsive')">&#9776;</a></div><div><a class=baselink href=https://xtls.github.io>Project X</a></div><nav class=shortcuts><li role><a href=/about/new rel=noopener>What's New</a></li><li role><a href=https://github.com/XTLS rel=noopener>GitHub</a></li><li role><a href=https://github.com/XTLS/Xray-core/releases rel=noopener>Download</a></li><li role><a href=https://xtls.github.io/ rel=noopener>Documentation</a></li></nav></div></header><article><aside><div class=search><div class=searchbox><input data-search-input id=search-by type=text placeholder></div><script type=text/javascript src=/vendor/lunr/lunr.min.js></script><script type=text/javascript src=/vendor/auto-complete/auto-complete.js></script><link href=/vendor/auto-complete/auto-complete.css rel=stylesheet><script type=text/javascript>var baseurl="https:\/\/xtls.github.io";</script><script type=text/javascript src=/js/search.js></script></div><center><a class=github-button href=https://github.com/XTLS/Xray-core/releases data-icon=octicon-cloud-download aria-label="Download vjeantet/hugo-theme-docport on GitHub">Download</a>
<a class=github-button href=https://github.com/XTLS/Xray-core data-icon=octicon-star data-show-count=false aria-label="Star vjeantet/hugo-theme-docport on GitHub">Star</a>
<a class=github-button href=https://github.com/XTLS/Xray-core/fork data-icon=octicon-repo-forked data-show-count=true aria-label="Fork vjeantet/hugo-theme-docport on GitHub">Fork</a></center>
<script async defer src=https://buttons.github.io/buttons.js></script><div id=close_menu><a href=javascript:void(0); style=font-size:15px onclick="$('article > aside').toggleClass('responsive')"><i class="fa fa-lg fa-times"></i></a></div><ul class=menu><hr><li data-nav-id=https://xtls.github.io/about/ class="dd-item haschildren
item_level_$level"><i class="fas fa-chevron-right ddexp"></i><a href=/about/>Project X&nbsp;⚡</a><ul><li data-nav-id=https://xtls.github.io/about/new/ class="dd-item
item_level_$level"><a href=/about/new/>大史记&nbsp;</a></li></ul></li><hr><li data-nav-id=https://xtls.github.io/guide/ class="dd-item alwaysopen
item_level_$level"><a href=/guide/>快速入门&nbsp;</a></li><li data-nav-id=https://xtls.github.io/config/ class="dd-item parent haschildren
item_level_$level"><i class="fas fa-chevron-down ddexp"></i><a href=/config/>配置文件&nbsp;📜</a><ul><li data-nav-id=https://xtls.github.io/config/base/ class="dd-item parent haschildren
item_level_$level"><a href=/config/base/>基础配置模块&nbsp;</a>
<i class="fas fa-chevron-down ddexp"></i><ul><li data-nav-id=https://xtls.github.io/config/base/log/ class="dd-item
item_level_$level"><a href=/config/base/log/>日志配置</a></li><li data-nav-id=https://xtls.github.io/config/base/api/ class="dd-item
item_level_$level"><a href=/config/base/api/>API接口</a></li><li data-nav-id=https://xtls.github.io/config/base/dns/ class="dd-item
item_level_$level"><a href=/config/base/dns/>内置DNS服务器</a></li><li data-nav-id=https://xtls.github.io/config/base/routing/ class="dd-item parent active
item_level_$level"><a href=/config/base/routing/>路由</a></li><li data-nav-id=https://xtls.github.io/config/base/policy/ class="dd-item
item_level_$level"><a href=/config/base/policy/>本地策略</a></li><li data-nav-id=https://xtls.github.io/config/base/inbounds/ class="dd-item
item_level_$level"><a href=/config/base/inbounds/>Inbounds</a></li><li data-nav-id=https://xtls.github.io/config/base/outbounds/ class="dd-item
item_level_$level"><a href=/config/base/outbounds/>Outbounds</a></li><li data-nav-id=https://xtls.github.io/config/base/transport/ class="dd-item
item_level_$level"><a href=/config/base/transport/>传输方式</a></li><li data-nav-id=https://xtls.github.io/config/base/stats/ class="dd-item
item_level_$level"><a href=/config/base/stats/>统计信息</a></li><li data-nav-id=https://xtls.github.io/config/base/reverse/ class="dd-item
item_level_$level"><a href=/config/base/reverse/>反向代理</a></li></ul></li><li data-nav-id=https://xtls.github.io/config/inbound-protocols/ class="dd-item
item_level_$level"><a href=/config/inbound-protocols/>Inbounds 可用协议列表</a></li><li data-nav-id=https://xtls.github.io/config/outbound-protocols/ class="dd-item
item_level_$level"><a href=/config/outbound-protocols/>Outbounds 可用协议列表</a></li><li data-nav-id=https://xtls.github.io/config/transports/ class="dd-item
item_level_$level"><a href=/config/transports/>传输方式列表</a></li><li data-nav-id=https://xtls.github.io/config/vless/ class="dd-item
item_level_$level"><a href=/config/vless/>VLESS 协议详解</a></li><li data-nav-id=https://xtls.github.io/config/fallback/ class="dd-item
item_level_$level"><a href=/config/fallback/>Fallbacks</a></li><li data-nav-id=https://xtls.github.io/config/xtls/ class="dd-item
item_level_$level"><a href=/config/xtls/>XTLS 深度剖析</a></li><li data-nav-id=https://xtls.github.io/config/env/ class="dd-item
item_level_$level"><a href=/config/env/>环境变量</a></li><li data-nav-id=https://xtls.github.io/config/multiple_config/ class="dd-item alwaysopen
item_level_$level"><a href=/config/multiple_config/>多文件配置</a></li></ul></li><li data-nav-id=https://xtls.github.io/documents/ class="dd-item haschildren
item_level_$level"><i class="fas fa-chevron-right ddexp"></i><a href=/documents/>使用心得&nbsp;📚</a><ul><li data-nav-id=https://xtls.github.io/documents/level-0/ class="dd-item alwaysopen
item_level_$level"><a href=/documents/level-0/>小小白白话文&nbsp;📙</a></li><li data-nav-id=https://xtls.github.io/documents/level-1/ class="dd-item alwaysopen
item_level_$level"><a href=/documents/level-1/>入门技巧&nbsp;📚</a></li><li data-nav-id=https://xtls.github.io/documents/level-2/ class="dd-item alwaysopen
item_level_$level"><a href=/documents/level-2/>进阶文档&nbsp;📘</a></li></ul></li><li data-nav-id=https://xtls.github.io/develop/ class="dd-item haschildren
item_level_$level"><i class="fas fa-chevron-right ddexp"></i><a href=/develop/>开发指南&nbsp;🖥️</a><ul><li data-nav-id=https://xtls.github.io/develop/intro/ class="dd-item alwaysopen
item_level_$level"><a href=/develop/intro/>开发手册</a></li><li data-nav-id=https://xtls.github.io/develop/protocols/ class="dd-item alwaysopen
item_level_$level"><a href=/develop/protocols/>协议详解</a></li></ul></li><li data-nav-id=https://xtls.github.io/faq/ class="dd-item alwaysopen
item_level_$level"><a href=/faq/>常见问答&nbsp;💬</a></li><li data-nav-id=https://xtls.github.io/caseslip/ class="dd-item alwaysopen
item_level_$level"><a href=/caseslip/>大案牍术&nbsp;</a></li><hr><li data-nav-id=https://xtls.github.io/links/ class="dd-item alwaysopen
item_level_$level"><a href=/links/>常用链接&nbsp;🤝</a></li></ul></aside><section class=page><nav id=ariane aria-label=breadcrumb><ol class=ariane><li><a class=text-link href=https://xtls.github.io></a></li><li><a class=text-link href=/config/>配置文件</a></li><li><a class=text-link href=/config/base/>基础配置模块</a></li><li class=active>路由</li></ol></nav><h1>路由</h1><div class=jump-to-section><span onclick="$h=$(this);$h.next('nav').slideToggle(100,function(){$h.children('i').attr('class',function(){return $h.next('nav').is(':visible')?'fas fa-chevron-down':'fas fa-chevron-right';});});"><span class="fas fa-align-right"></span><i class="fas fa-chevron-right"></i></span><nav id=TableOfContents><ul><li><a href=#routingobject>RoutingObject</a><ul><li><a href=#ruleobject>RuleObject</a></li><li><a href=#balancerobject>BalancerObject</a></li><li><a href=#预定义域名列表>预定义域名列表</a></li></ul></li></ul></nav></div><div class=content><p>路由功能模块可以将入站数据按不同规则由不同的出站连接发出，以达到按需代理的目的。</p><p>如常见用法是分流国内外流量，Xray 可以通过内部机制判断不同地区的流量，然后将它们发送到不同的出站代理。</p><h2 ref=routingobject>RoutingObject</h2><a class=anchor id=routingobject></a><hr><p><code>RoutingObject</code> 对应配置文件的 <code>routing</code> 项。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-json data-lang=json>{
  <span style=color:#f92672>&#34;routing&#34;</span>: {
    <span style=color:#f92672>&#34;domainStrategy&#34;</span>: <span style=color:#e6db74>&#34;AsIs&#34;</span>,
    <span style=color:#f92672>&#34;rules&#34;</span>: [],
    <span style=color:#f92672>&#34;balancers&#34;</span>: []
  }
}
</code></pre></div><div class="notices dark"><p><code>domainStrategy</code>: &ldquo;AsIs&rdquo; | &ldquo;IPIfNonMatch&rdquo; | &ldquo;IPOnDemand&rdquo;</p></div><p>域名解析策略，根据不同的设置使用不同的策略。</p><ul><li><code>"AsIs"</code>：只使用域名进行路由选择。默认值。</li><li><code>"IPIfNonMatch"</code>：当域名没有匹配任何规则时，将域名解析成 IP（A 记录或 AAAA 记录）再次进行匹配；<ul><li>当一个域名有多个 A 记录时，会尝试匹配所有的 A 记录，直到其中一个与某个规则匹配为止；</li><li>解析后的 IP 仅在路由选择时起作用，转发的数据包中依然使用原始域名；</li></ul></li><li><code>"IPOnDemand"</code>：当匹配时碰到任何基于 IP 的规则，将域名立即解析为 IP 进行匹配；</li></ul><div class="notices dark"><p><code>rules</code>: [<a href=#ruleobject>RuleObject</a>]</p></div><p>对应一个数组，数组中每个元素是一个规则。</p><p>对于每一个连接，路由将根据这些规则依次进行判断，当一个规则生效时，即将这个连接转发至它所指定的 <code>outboundTag</code>或 <code>balancerTag</code>。</p><div class="notices info"><p><strong>TIP</strong><br>当没有匹配到任何规则时，流量默认由第一个outbound发出。</p></div><div class="notices dark"><p><code>balancers</code>: [ <a href=#balancerobject>BalancerObject</a> ]</p></div><p>一个数组，数组中每个元素是一个负载均衡器的配置。</p><p>当一个规则指向一个负载均衡器时，Xray 会通过此负载均衡器选出一个outbound, 然后由它转发流量。</p><p><br></p><h3 ref=ruleobject>RuleObject</h3><a class=anchor id=ruleobject></a><hr><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-json data-lang=json>{
    <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;field&#34;</span>,
    <span style=color:#f92672>&#34;domain&#34;</span>: [
        <span style=color:#e6db74>&#34;baidu.com&#34;</span>,
        <span style=color:#e6db74>&#34;qq.com&#34;</span>,
        <span style=color:#e6db74>&#34;geosite:cn&#34;</span>
    ],
    <span style=color:#f92672>&#34;ip&#34;</span>: [
        <span style=color:#e6db74>&#34;0.0.0.0/8&#34;</span>,
        <span style=color:#e6db74>&#34;10.0.0.0/8&#34;</span>,
        <span style=color:#e6db74>&#34;fc00::/7&#34;</span>,
        <span style=color:#e6db74>&#34;fe80::/10&#34;</span>,
        <span style=color:#e6db74>&#34;geoip:cn&#34;</span>
    ],
    <span style=color:#f92672>&#34;port&#34;</span>: <span style=color:#e6db74>&#34;53,443,1000-2000&#34;</span>,
    <span style=color:#f92672>&#34;sourcePort&#34;</span>: <span style=color:#e6db74>&#34;53,443,1000-2000&#34;</span>,
    <span style=color:#f92672>&#34;network&#34;</span>: <span style=color:#e6db74>&#34;tcp&#34;</span>,
    <span style=color:#f92672>&#34;source&#34;</span>: [
        <span style=color:#e6db74>&#34;10.0.0.1&#34;</span>
    ],
    <span style=color:#f92672>&#34;user&#34;</span>: [
        <span style=color:#e6db74>&#34;love@xray.com&#34;</span>
    ],
    <span style=color:#f92672>&#34;inboundTag&#34;</span>: [
        <span style=color:#e6db74>&#34;tag-vmess&#34;</span>
    ],
    <span style=color:#f92672>&#34;protocol&#34;</span>: [
        <span style=color:#e6db74>&#34;http&#34;</span>,
        <span style=color:#e6db74>&#34;tls&#34;</span>,
        <span style=color:#e6db74>&#34;bittorrent&#34;</span>
    ],
    <span style=color:#f92672>&#34;attrs&#34;</span>: <span style=color:#e6db74>&#34;attrs[&#39;:method&#39;] == &#39;GET&#39;&#34;</span>,
    <span style=color:#f92672>&#34;outboundTag&#34;</span>: <span style=color:#e6db74>&#34;direct&#34;</span>,
    <span style=color:#f92672>&#34;balancerTag&#34;</span>: <span style=color:#e6db74>&#34;balancer&#34;</span>
}
</code></pre></div><p><br><div class="notices danger"><label>important</label><p>当多个属性同时指定时，这些属性需要 <strong>同时</strong> 满足，才可以使当前规则生效。</p></div><br></p><div class="notices dark"><p><code>type</code>: &ldquo;field&rdquo;</p></div><p>目前只支持<code>"field"</code>这一个选项。</p><div class="notices dark"><p><code>domain</code>: [string]</p></div><p>一个数组，数组每一项是一个域名的匹配。有以下几种形式：</p><ul><li>纯字符串：当此字符串匹配目标域名中任意部分，该规则生效。比如 &ldquo;sina.com&rdquo; 可以匹配 &ldquo;sina.com&rdquo;、&ldquo;sina.com.cn&rdquo; 和"www.sina.com"，但不匹配 &ldquo;sina.cn&rdquo;。</li><li>正则表达式：由 <code>"regexp:"</code> 开始，余下部分是一个正则表达式。当此正则表达式匹配目标域名时，该规则生效。例如 &ldquo;regexp:\\.goo.*\\.com$&rdquo; 匹配"www.google.com"或 &ldquo;fonts.googleapis.com&rdquo;，但不匹配 &ldquo;google.com&rdquo;。</li><li>子域名（推荐）：由 <code>"domain:"</code> 开始，余下部分是一个域名。当此域名是目标域名或其子域名时，该规则生效。例如 &ldquo;domain:xray.com&rdquo; 匹配"www.xray.com"、&ldquo;xray.com&rdquo;，但不匹配 &ldquo;wxray.com&rdquo;。</li><li>完整匹配：由 <code>"full:"</code> 开始，余下部分是一个域名。当此域名完整匹配目标域名时，该规则生效。例如 &ldquo;full:xray.com&rdquo; 匹配 &ldquo;xray.com&rdquo; 但不匹配"www.xray.com"。</li><li>预定义域名列表：由 <code>"geosite:"</code> 开头，余下部分是一个名称，如 <code>geosite:google</code> 或者 <code>geosite:cn</code>。名称及域名列表参考 <a href=#%E9%A2%84%E5%AE%9A%E4%B9%89%E5%9F%9F%E5%90%8D%E5%88%97%E8%A1%A8>预定义域名列表</a>。</li><li>从文件中加载域名：形如 <code>"ext:file:tag"</code>，必须以 <code>ext:</code>（小写）开头，后面跟文件名和标签，文件存放在 <a href=../../env#%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84>资源目录</a> 中，文件格式与 <code>geosite.dat</code> 相同，标签必须在文件中存在。<div class="notices info"><p><strong>TIP</strong><br><code>"ext:geoip.dat:cn"</code> 等价于 <code>"geoip:cn"</code></p></div></li></ul><div class="notices dark"><p><code>ip</code>: [string]</p></div><p>一个数组，数组内每一个元素代表一个 IP 范围。当某一元素匹配目标 IP 时，此规则生效。有以下几种形式：</p><ul><li>IP：形如 <code>"127.0.0.1"</code>。</li><li><a href=https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing>CIDR</a>：形如 <code>"10.0.0.0/8"</code>。</li><li>预定义IP列表：此列表预置于每一个 Xray 的安装包中，文件名为 <code>geoip.dat</code>。使用方式形如 <code>"geoip:cn"</code>，必须以 <code>geoip:</code>（小写）开头，后面跟双字符国家代码，支持几乎所有可以上网的国家。<ul><li>特殊值：<code>"geoip:private"</code>，包含所有私有地址，如 <code>127.0.0.1</code>。</li></ul></li><li>从文件中加载 IP：形如 <code>"ext:file:tag"</code>，必须以 <code>ext:</code>（小写）开头，后面跟文件名和标签，文件存放在 <a href=../../env#%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84>资源目录</a> 中，文件格式与 <code>geoip.dat</code> 相同标签必须在文件中存在。</li></ul><div class="notices dark"><p><code>port</code>：number | string</p></div><p>目标端口范围，有三种形式：</p><ul><li><code>"a-b"</code>：a 和 b 均为正整数，且小于 65536。这个范围是一个前后闭合区间，当目标端口落在此范围内时，此规则生效。</li><li><code>a</code>：a 为正整数，且小于 65536。当目标端口为 a 时，此规则生效。</li><li>以上两种形式的混合，以逗号 &ldquo;,&rdquo; 分隔。形如：<code>"53,443,1000-2000"</code>。</li></ul><div class="notices dark"><p><code>sourcePort</code>：number | string</p></div><p>来源端口，有三种形式：</p><ul><li><code>"a-b"</code>：a 和 b 均为正整数，且小于 65536。这个范围是一个前后闭合区间，当目标端口落在此范围内时，此规则生效。</li><li><code>a</code>：a 为正整数，且小于 65536。当目标端口为 a 时，此规则生效。</li><li>以上两种形式的混合，以逗号 &ldquo;,&rdquo; 分隔。形如：<code>"53,443,1000-2000"</code>。</li></ul><div class="notices dark"><p><code>network</code>: &ldquo;tcp&rdquo; | &ldquo;udp&rdquo; | &ldquo;tcp,udp&rdquo;</p></div><p>可选的值有 &ldquo;tcp&rdquo;、&ldquo;udp&rdquo; 或 &ldquo;tcp,udp&rdquo;，当连接方式是指定的方式时，此规则生效。</p><div class="notices dark"><p><code>source</code>: [string]</p></div><p>一个数组，数组内每一个元素代表一个 IP 范围。当某一元素匹配目标 IP 时，此规则生效。有以下几种形式：</p><ul><li>IP：形如 <code>"127.0.0.1"</code>。</li><li><a href=https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing>CIDR</a>：形如 <code>"10.0.0.0/8"</code>。</li><li>预定义IP列表：此列表预置于每一个 Xray 的安装包中，文件名为 <code>geoip.dat</code>。使用方式形如 <code>"geoip:cn"</code>，必须以 <code>geoip:</code>（小写）开头，后面跟双字符国家代码，支持几乎所有可以上网的国家。<ul><li>特殊值：<code>"geoip:private"</code>，包含所有私有地址，如 <code>127.0.0.1</code>。</li></ul></li><li>从文件中加载 IP：形如 <code>"ext:file:tag"</code>，必须以 <code>ext:</code>（小写）开头，后面跟文件名和标签，文件存放在 <a href=../../env#%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84>资源目录</a> 中，文件格式与 <code>geoip.dat</code> 相同标签必须在文件中存在。</li></ul><div class="notices dark"><p><code>user</code>: [string]</p></div><p>一个数组，数组内每一个元素是一个邮箱地址。当某一元素匹配来源用户时，此规则生效。</p><div class="notices dark"><p><code>inboundTag</code>: [string]</p></div><p>一个数组，数组内每一个元素是一个标识。当某一元素匹配入站协议的标识时，此规则生效。</p><div class="notices dark"><p><code>protocol</code>: [ &ldquo;http&rdquo; | &ldquo;tls&rdquo; | &ldquo;bittorrent&rdquo; ]</p></div><p>一个数组，数组内每一个元素表示一种协议。当某一个协议匹配当前连接的协议类型时，此规则生效。<div class="notices info"><p><strong>TIP</strong><br>必须开启入站代理中的 <code>sniffing</code> 选项, 才能嗅探出连接所使用的协议类型.</p></div></p><div class="notices dark"><p><code>attrs</code>: string</p></div><p>一段脚本，用于检测流量的属性值。当此脚本返回真值时，此规则生效。</p><p>脚本语言为 <a href=https://github.com/bazelbuild/starlark>Starlark</a>，它的语法是 Python 的子集。脚本接受一个全局变量 <code>attrs</code>，其中包含了流量相关的属性。</p><p>目前只有 http 入站代理会设置这一属性。</p><p>示例：</p><ul><li>检测 HTTP GET：<code>"attrs[':method'] == 'GET'"</code></li><li>检测 HTTP Path：<code>"attrs[':path'].startswith('/test')"</code></li><li>检测 Content Type：<code>"attrs['accept'].index('text/html') >= 0"</code></li></ul><div class="notices dark"><p><code>outboundTag</code>: string</p></div><p>对应一个outbound的标识。</p><div class="notices dark"><p><code>balancerTag</code>: string</p></div><p>对应一个Balancer的标识。</p><div class="notices info"><p><strong>TIP</strong><br><code>balancerTag</code> 和 <code>outboundTag</code> 须二选一。当同时指定时，<code>outboundTag</code> 生效。</p></div><p><br></p><h3 ref=balancerobject>BalancerObject</h3><a class=anchor id=balancerobject></a><hr><p>负载均衡器配置。当一个负载均衡器生效时，它会从指定的outbound中，按配置选出一个最合适的outbound，进行流量转发。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-json data-lang=json>{
    <span style=color:#f92672>&#34;tag&#34;</span>: <span style=color:#e6db74>&#34;balancer&#34;</span>,
    <span style=color:#f92672>&#34;selector&#34;</span>: []
}
</code></pre></div><div class="notices dark"><p><code>tag</code>: string</p></div><p>此负载均衡器的标识，用于匹配 <code>RuleObject</code> 中的 <code>balancerTag</code>。</p><div class="notices dark"><p><code>selector</code>: [ string ]</p></div><p>一个字符串数组，其中每一个字符串将用于和outbound标识的前缀匹配。在以下几个outbound标识中：<code>[ "a", "ab", "c", "ba" ]</code>，<code>"selector": ["a"]</code> 将匹配到 <code>[ "a", "ab" ]</code>。</p><p>如果匹配到多个outbound，负载均衡器目前会从中随机选出一个作为最终的outbound。</p><p><br></p><h3 ref=预定义域名列表>预定义域名列表</h3><a class=anchor id=预定义域名列表></a><hr><p>此列表预置于每一个 Xray 的安装包中，文件名为 <code>geosite.dat</code>。这个文件包含了一些常见的域名，使用方式：<code>geosite:filename</code>，如 <code>geosite:google</code> 表示对文件内符合 <code>google</code> 内包含的域名，进行路由筛选或 DNS 筛选。</p><p>常见的域名有：</p><ul><li><code>category-ads</code>：包含了常见的广告域名。</li><li><code>category-ads-all</code>：包含了常见的广告域名，以及广告提供商的域名。</li><li><code>cn</code>：相当于 <code>geolocation-cn</code> 和 <code>tld-cn</code> 的合集。</li><li><code>apple</code>：包含了 Apple 旗下绝大部分域名。</li><li><code>google</code>：包含了 Google 旗下绝大部分域名。</li><li><code>microsoft</code>：包含了 Microsoft 旗下绝大部分域名。</li><li><code>facebook</code>：包含了 Facebook 旗下绝大部分域名。</li><li><code>twitter</code>：包含了 Twitter 旗下绝大部分域名。</li><li><code>telegram</code>：包含了 Telegram 旗下绝大部分域名。</li><li><code>geolocation-cn</code>：包含了常见的大陆站点域名。</li><li><code>geolocation-!cn</code>：包含了常见的非大陆站点域名，同时包含了 <code>tld-!cn</code>。</li><li><code>tld-cn</code>：包含了 CNNIC 管理的用于中国大陆的顶级域名，如以 <code>.cn</code>、<code>.中国</code> 结尾的域名。</li><li><code>tld-!cn</code>：包含了非中国大陆使用的顶级域名，如以 <code>.hk</code>（香港）、<code>.tw</code>（台湾）、<code>.jp</code>（日本）、<code>.sg</code>（新加坡）、<code>.us</code>（美国）<code>.ca</code>（加拿大）等结尾的域名。</li></ul></div><div class=chevrons></div></section><section class=right-menu><div class=TableOfContents><label><i class="fas fa-align-right"></i>&nbsp;&nbsp;</label><nav><ul><li><a href=/config/base/routing/>路由</a></li></ul></nav><nav id=TableOfContents><ul><li><a href=#routingobject>RoutingObject</a><ul><li><a href=#ruleobject>RuleObject</a></li><li><a href=#balancerobject>BalancerObject</a></li><li><a href=#预定义域名列表>预定义域名列表</a></li></ul></li></ul></nav></div><div class=Actions><nav><ul><li><a href=https://github.com/XTLS/XTLS.github.io/tree/main/content/config/base/routing/_index.md target=blank><i class="fab fa-github"></i></a></li><li><i class="fas fa-calendar"></i>23 December 2020</li></ul></nav></div></section></article><footer><footer><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank rel="noopener noreferrer" href=https://example.org/mail><i class="fa fa-envelope"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel="noopener noreferrer" href=https://example.org/twitter><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow"><a class=text-white target=_blank rel="noopener noreferrer" href=https://example.org/stack><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel="noopener noreferrer" href=https://github.com/XTLS><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank rel="noopener noreferrer" href=https://example.org/slack><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Developer mailing list" aria-label="Developer mailing list"><a class=text-white target=_blank rel="noopener noreferrer" href=https://example.org/mail><i class="fa fa-envelope"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2020-2021 ProjectX Community All Rights Reserved</small></div></div></div></footer></footer></body></html>